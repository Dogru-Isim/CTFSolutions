# THM: Relevant
# OS: Windows (Medium)

----

**Rules:**

- Any tools or techniques are permitted in this engagement, however we ask that you attempt manual exploitation first
- Locate and note all vulnerabilities found
- Submit the flags discovered to the dashboard
- Only the IP address assigned to your machine is in scope
- Find and report ALL vulnerabilities (yes, there is more than one path to root)

----

### [NOTES]

- Target is vulnerable to MS17-10 (Eternal Blue)

- SMB has a base64 encoded passwords file

- SMB `nt4wrksv` is the `http://$ip:49663/nt4wrksv` directory.

- `iis apppool\defaultapppool` has `SeImpersonatePrivilege`

Names:

- Bob

- Bill

Credentials:

- Bob:!P@$$W0rD!123
- Bill:Juw4nnaM4n420696969!$$$

----

## External

### [WEB]

**Port -> 80**

- Found IIS default page

**Port -> 49663**

- Found IIS default page
- We can upload to `http://$ip:49663/nt4wrksv/` from SMB with no creds.

### [SMB]

- SMB Signing is disabled

- SMBv1 is used (out-of-date)

- Anonymous login with no password is enabled
 

- Found password file with `guest:<nopass>`
  
  - The file has base64 encoded credentials.

- Found creds:
  
  - `Bob:!P@$$W0rD!123`

----

----

## Internal

- `iis apppool\defaultapppool` has  `SeImpersonatePrivilege` which can be used to get system with a Potato attack. (Potato attacks doesn't work)
